@{
    ViewData["Title"] = "Home Page";
}

<div class="text-center">
    <h1 class="display-4">Welcome to 30 Seconds Namibia Style!</h1>
    <p class="lead">Click the button below to generate a random card and start the timer!</p>
    <button id="generateCardsBtn" class="btn btn-primary btn-lg mt-3">Generate Cards</button>
    <div id="timerDisplay" class="mt-3" style="font-size: 1.5rem; font-weight: bold;"></div>
</div>

<div id="cardsContainer" class="mt-5 container d-flex justify-content-center">
    <!-- A single card will be dynamically added here -->
</div>

<script>
    let timerInterval;

    function startTimer(durationInSeconds) {
        const timerDisplay = document.getElementById("timerDisplay");
        let remainingTime = durationInSeconds;

        // Update the timer display every second
        timerDisplay.textContent = `Time left: ${remainingTime}s`;
        timerInterval = setInterval(() => {
            remainingTime--;

            if (remainingTime <= 0) {
                clearInterval(timerInterval);
                timerDisplay.textContent = "Time's up!";
                alert("Time's up! Better luck next round!");
            } else {
                timerDisplay.textContent = `Time left: ${remainingTime}s`;
            }
        }, 1000);
    }

    document.getElementById("generateCardsBtn").addEventListener("click", function () {
        fetch('/Home/GetNamibianCards')
            .then(response => response.json())
            .then(data => {
                const cardsContainer = document.getElementById("cardsContainer");
                cardsContainer.innerHTML = ""; // Clear the previous card

                // Select a random card from the data
                const randomCard = data[Math.floor(Math.random() * data.length)];

                // Create a new card element
                const cardElement = document.createElement("div");
                cardElement.className = "card m-3";
                cardElement.style.width = "18rem";
                cardElement.style.border = "2px solid";

                // Set the border color based on Namibian flag colors
                const colors = ["red", "blue", "green", "yellow"];
                cardElement.style.borderColor = colors[Math.floor(Math.random() * colors.length)];

                const cardBody = document.createElement("div");
                cardBody.className = "card-body";

                // Add card title
                const cardTitle = document.createElement("h5");
                cardTitle.className = "card-title";
                cardTitle.textContent = `Namibian Card`;
                cardBody.appendChild(cardTitle);

                // Add list of words
                const cardList = document.createElement("ul");
                cardList.className = "list-group list-group-flush";
                randomCard.forEach(word => {
                    const listItem = document.createElement("li");
                    listItem.className = "list-group-item";
                    listItem.textContent = word;
                    cardList.appendChild(listItem);
                });

                // Append card body and list to card, then append card to container
                cardElement.appendChild(cardBody);
                cardElement.appendChild(cardList);
                cardsContainer.appendChild(cardElement);

                // Start the 30-second timer
                clearInterval(timerInterval); // Clear any existing timer
                startTimer(30);
            })
            .catch(error => console.error("Error fetching cards:", error));
    });
</script>
